
# Лабораторный отчёт – День 13


**ФИО:** Гул Керим Аллалович
 
**Дата выполнения:** 16.06.2025

**Преподаватель:** Виталий Новиков 


---

## 1. Тема и цель работы

**Тема:** Анализ уязвимостей

**Цель работы:**

Приобретение практических навыков анализа сетевого трафика для расследования инцидентов безопасности. В ходе работы необходимо было обработать файл захвата трафика (PCAP) с помощью сетевого анализатора Zeek, выявить индикаторы компрометации (IOC), построить временную шкалу событий и составить отчет на основе собранных доказательств.

---

## 2. Теоретическая часть

-   **CSIRT (Computer Security Incident Response Team) этапы:** Стандартизированный жизненный цикл реагирования на инциденты, включающий шесть фаз: **1. Обнаружение (Detection)**, **2. Оценка (Triage)**, **3. Сдерживание (Containment)**, **4. Ликвидация (Eradication)**, **5. Восстановление (Recovery)** и **6. Анализ и извлечение уроков (Lessons Learned)**. Данная лабораторная работа фокусируется на первых двух этапах.

-   **Индикаторы компрометации (IOC):** Артефакты или улики, указывающие на то, что система или сеть была скомпрометирована. Ключевые типы IOC, используемые в работе:
    -   **IP-адрес:** Уникальный сетевой адрес, который может принадлежать вредоносному серверу (C2).
    -   **Домен:** Имя сайта, используемое для фишинга или распространения вредоносного ПО.
    -   **Хеш-сумма:** Уникальный отпечаток файла, позволяющий идентифицировать вредоносное ПО.

-   **Zeek (ранее Bro):** Мощный фреймворк для анализа сетевого трафика. В отличие от пакетных анализаторов вроде Wireshark, Zeek не просто разбирает пакеты, а интерпретирует их и создает высокоуровневые, структурированные лог-файлы по каждому протоколу (`conn.log`, `dns.log`, `http.log` и т.д.).

-   **PCAP (Packet Capture):** Стандартный формат файла для хранения захваченного сетевого трафика. Является исходным данным для анализа.

-   **VirusTotal:** Онлайн-сервис, который агрегирует данные от десятков антивирусных сканеров и сервисов сканирования веб-сайтов для проверки файлов, URL, IP-адресов и доменов на вредоносность.

---


## 3. Ход работы

Работа по анализу инцидента проводилась в несколько последовательных этапов. Сначала исходный файл ([suspect.pcap](https://github.com/Nelass1c/practica-konvey/tree/main/day13/suspect.pcap))
 был обработан с помощью фреймворка Zeek для генерации структурированных логов. Затем, используя утилиту zeek-cut и стандартные команды терминала, были проанализированы ключевые логи для поиска аномалий. Обнаруженные индикаторы были верифицированы с помощью внешнего сервиса VirusTotal.

### 3.1 Используемые команды

```bash
# 1. Генерация логов из pcap-файла
zeek -r suspect.pcap

# 2. Анализ DNS-запросов для выявления подозрительных доменов
zeek-cut query < dns.log | sort | uniq -c | sort -rn

# 3. Анализ HTTP-трафика для изучения посещенных URL
zeek-cut id.orig_h id.resp_h host uri < http.log | less

# 4. Анализ сетевых соединений для поиска коммуникаций с C2
zeek-cut id.orig_h id.resp_h id.resp_p proto < conn.log | sort | uniq -c | sort -rn | head -n 20
```

### 3.2 Скриншоты

-   **Ключевые скриншоты:**

    ![Скриншот 1: Анализ DNS и HTTP логов](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day13/screenshots/s3.jpg)
    * На скриншоте виден результат анализа `dns.log` (вверху), где был обнаружен запрос к домену `www.pcapworkshop.net`. В нижней части вывод `http.log` подтверждает, что внутренний хост `172.16.1.35` действительно обращался по этому адресу.

    ![Скриншот 2: Анализ сетевых соединений](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day13/screenshots/s2.jpg)
    * Вывод команды для анализа `conn.log` показывает прямое TCP-соединение от хоста `172.16.1.35` к внешнему IP-адресу `203.161.53.240` по порту 80 (HTTP). Это доказывает факт установления сессии с сайтом, найденным на предыдущем шаге.

    ![Скриншот 3: Проверка IP-адреса на VirusTotal](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day13/screenshots/s1.png)
    * IP-адрес `203.161.53.240` был проверен через сервис VirusTotal. Результат показывает, что один из вендоров безопасности пометил этот IP как вредоносный (Malicious), что является ключевым доказательством инцидента.

---


## 4. Результаты

В ходе анализа сетевого трафика был выявлен инцидент безопасности. Внутренний хост с IP-адресом **`172.16.1.35`** установил соединение с внешним IP-адресом **`203.161.53.240`**, который, по данным сервиса VirusTotal, имеет статус **вредоносного (Malicious)**.

Были идентифицированы следующие индикаторы компрометации (IOC):

| Тип IOC | Значение | Описание |
| :--- | :--- | :--- |
| Внутренний IP | `172.16.1.35` | Предположительно скомпрометированный хост в локальной сети. |
| Домен | `www.pcapworkshop.net` | Домен, к которому обращался хост перед соединением с вредоносным IP. |
| Внешний IP | `203.161.53.240` | Вредоносный IP-адрес, подтвержденный через VirusTotal. |

---

## 5. Выводы

-   **Какие знания были закреплены?**
    Были закреплены практические навыки по анализу сетевых инцидентов. Я научился использовать Zeek для преобразования сырого трафика в структурированные логи и применять утилиты командной строки (`zeek-cut`) для их анализа. Также я понял важность корреляции данных между разными логами (`dns`, `http`, `conn`) и использования внешних сервисов, таких как VirusTotal, для подтверждения гипотез.

-   **Что показалось сложным?**
    На начальном этапе возникли сложности с автоматизацией анализа, в частности, с написанием Python-скрипта для корректного парсинга специфического формата Zeek-логов. Поиск правильных параметров для чтения данных потребовал нескольких итераций.

-   **Какой инструмент был наиболее полезен?**
    Наиболее полезным инструментом оказался **Zeek**. Он позволил превратить сложный для восприятия pcap-файл в набор понятных текстовых логов, что сделало возможным дальнейший пошаговый анализ и быстрое обнаружение ключевых событий.

---
