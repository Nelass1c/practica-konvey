
# Лабораторный отчёт – День 5


**ФИО:** Гул Керим Аллалович
 
**Дата выполнения:** 06.06.2025

**Преподаватель:** Виталий Новиков 


---

## 1. Тема и цель работы

**Тема:** DHCP и NAT

**Цели работы:**

- Изучить работу протокола DHCP (Dynamic Host Configuration Protocol) путем принудительного обновления IP-адреса на сетевом интерфейсе.
- Получить практические навыки по захвату и анализу DHCP-трафика с использованием сетевого анализатора Wireshark.
- Освоить использование фильтров Wireshark по номерам портов (port 67 or 68) для изоляции DHCP-сообщений.
- Понять концепцию NAT (Network Address Translation) путем сравнения внутреннего (локального) IP-адреса, полученного по DHCP, и внешнего (публичного) IP-адреса, видимого в интернете.

---

## 2. Теоретическая часть

Ключевые понятия, используемые в лабораторной работе:

- DHCP 
- Процесс DORA: Четырехэтапный процесс получения IP-адреса по DHCP: Discover, Offer, Request, Ack.
- Private IP диапазоны (Class A, B, C)
- NAT 
- PAT (Port Address Translation): Расширение NAT (часто называется "маскарадинг"), которое подменяет не только IP-адрес, но и порт источника

---

## 3. Ход работы

Основной задачей было изучение процесса получения IP-адреса по протоколу DHCP и демонстрация работы механизма NAT. Для этого была выполнена процедура принудительного переподключения сетевого интерфейса, что инициировало обмен DHCP-сообщениями. Весь процесс был зафиксирован с помощью сетевого анализатора Wireshark, после чего была проведена проверка внешнего IP-адреса для сравнения с локальным.

### 3.1. Используемые команды

**Управление сетевым интерфейсом и DHCP-клиентом:**

```bash
sudo nmcli device disconnect eth0

sudo nmcli device connect eth0
```

**Фильтрация трафика в Wireshark:**

```bash
dhcpv6 || dhcp
```

**Проверка внешнего IP-адреса с помощью:**

```bash
curl ifconfig.me
```

### 3.2. Скриншоты

Отключение и последующее подключение интерфейса принудительно запускает процесс получения нового IP-адреса от DHCP-сервера:

![получения нового IP-адреса от DHCP-сервера](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day5/screenshots/s1.jpg)

Наблюдение: Как видно на скриншоте, внешний IPv6-адрес изменился после переподключения, что указывает на его динамический характер. А вот мой внешний IPv4-адрес остался неизменным, что говорит о его статическом назначении провайдером (его я не скринил).

![Проверка внешнего IP и переподключение интерфейса](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day5/screenshots/s2.jpg)

Параллельно с переподключением интерфейса был запущен захват трафика в Wireshark с фильтром для DHCP (`dhcpv6 || dhcp`). Захват демонстрирует DHCP-обмен, который был инициирован при подключении интерфейса. В данном случае виден не полный цикл DORA, а его сокращенная версия (Request и ACK), так как клиент уже знал свой предыдущий IP-адрес и пытался его подтвердить.

![Захват DHCP-трафика в Wireshark](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day5/screenshots/s3.jpg)

---

### 4. Результаты

*   Было выполнено принудительное переподключение сетевого интерфейса `eth0` для инициации DHCP-обмена.
*   В Wireshark был успешно захвачен и отфильтрован DHCP-трафик, в частности, были идентифицированы пакеты DHCP Request и DHCP ACK.
*   С помощью команды `curl ifconfig.me` был определен внешний IP-адрес до и после переподключения.
*   Было установлено, что локальный IP-адрес (полученный по DHCP) отличается от внешнего, что демонстрирует работу механизма NAT. Также было замечено, что внешний IPv6-адрес менялся, в отличие от IPv4-адреса.
*   Все необходимые скриншоты и pcap-файлы сохранены.

---

### 5. Выводы

*   **Закреплены навыки:** Освоен процесс анализа DHCP-трафика для понимания механизма автоматического назначения IP-адресов. Получен практический опыт в использовании `nmcli` для управления сетевыми интерфейсами и `curl` для проверки внешнего IP. Улучшено понимание концепции NAT/PAT через сравнение внутренних и внешних адресов.

*   **Что показалось сложным:** Отличить сокращенный DHCP-обмен (Request-ACK) от полного четырехэтапного процесса DORA (Discover-Offer-Request-Ack), который происходит при первом подключении к сети.

*   **Какой инструмент был наиболее полезен:** Wireshark оказался ключевым инструментом для визуализации и анализа DHCP-пакетов. Команды `nmcli` и `curl` предоставили простой и эффективный способ для генерации необходимого трафика и проверки результатов.

---