
# Лабораторный отчёт – День 3


**ФИО:** Гул Керим Аллалович
 
**Дата выполнения:** 04.06.2025

**Преподаватель:** Виталий Новиков 


---

## 1. Тема и цель работы

**Тема:** Канальный уровень

**Цели работы:**
- Разобраться в механизме работы протокола ARP для определения MAC-адресов по IP-адресам в пределах локальной сети.
- Проанализировать процесс обмена сообщениями протокола ICMP при использовании утилиты `ping` для проверки доступности сетевого узла.
- Получить практические навыки по захвату и анализу ARP и ICMP трафика с использованием сетевого анализатора Wireshark.
- Ознакомиться с использованием команды `ip neigh` для просмотра и управления ARP-кэшем операционной системы.
---

## 2. Теоретическая часть

Ключевые понятия, используемые в лабораторной работе:

*   **Канальный уровень (Data Link Layer):** Уровень сетевой модели OSI (и TCP/IP), отвечающий за передачу данных (кадров) между двумя непосредственно соединенными узлами в одной физической сети. Обеспечивает физическую адресацию (MAC-адреса) и может выполнять обнаружение ошибок. Ethernet – типичный протокол этого уровня.
*   **Ethernet-кадр:** Базовая единица данных на канальном уровне в сетях Ethernet. Содержит MAC-адрес назначения, MAC-адрес источника, поле EtherType (указывающее тип инкапсулированного протокола верхнего уровня, например, 0x0800 для IPv4, 0x0806 для ARP), полезную нагрузку (данные) и контрольную сумму кадра (FCS/CRC) для проверки целостности.
*   **MAC-адрес (Media Access Control address):** Уникальный аппаратный идентификатор, присваиваемый сетевому интерфейсу производителем. Используется на канальном уровне для доставки кадров в пределах одного сегмента сети.
*   **ARP (Address Resolution Protocol):** Протокол, используемый для динамического сопоставления IP-адреса (логического адреса сетевого уровня) с MAC-адресом (физическим адресом канального уровня) в локальной сети (например, Ethernet).
    *   **ARP Request (Запрос):** Широковещательный запрос, отправляемый хостом, который хочет узнать MAC-адрес другого хоста в той же сети по его IP-адресу. Содержит Opcode 1.
    *   **ARP Reply (Ответ):** Одноадресный ответ на ARP Request, содержащий запрашиваемый MAC-адрес. Содержит Opcode 2.
*   **ARP-кэш (ARP cache / ARP table):** Динамически обновляемая таблица на каждом сетевом узле, хранящая временные сопоставления IP-адресов и соответствующих им MAC-адресов для устройств в локальной сети. Позволяет избежать повторных ARP-запросов для уже известных хостов.
*   **ICMP (Internet Control Message Protocol):** Протокол сетевого уровня, используемый сетевыми устройствами (включая маршрутизаторы) для отправки сообщений об ошибках (например, "узел недоступен") и оперативной информации (например, эхо-запросы/ответы для `ping`). Инкапсулируется в IP-пакеты.
    *   **ICMP Echo Request (Тип 8):** Сообщение, отправляемое утилитой `ping` для проверки доступности и времени отклика удаленного узла.
    *   **ICMP Echo Reply (Тип 0):** Ответ удаленного узла на ICMP Echo Request.
*   **`ping`:** Стандартная сетевая утилита для проверки доступности хоста в IP-сети и измерения времени приема-передачи пакетов (RTT) путем отправки ICMP Echo Request и ожидания ICMP Echo Reply.
*   **TTL (Time To Live):** Поле в заголовке IP-пакета, значение которого уменьшается на единицу каждым маршрутизатором на пути следования пакета. Если TTL достигает нуля до того, как пакет доставлен, пакет отбрасывается, что предотвращает его бесконечную циркуляцию в сети.
*   **`ip neigh`:** Команда в Linux для просмотра и управления ARP-кэшем (таблицей соседей).

---

## 3. Ход работы

### 3.1. Используемые команды

**Узнать IP-адрес шлюза:**
```bash
ip route
```
**Выполнить ping шлюза**
```bash
ping -c 4 192.168.1.1
```

### 3.2. Скриншоты

![Определение шлюза командой ip route](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day3/screenshots/s1.jpg)

Определение IP-адреса шлюза по умолчанию (`192.168.1.1`) и используемого сетевого интерфейса (`eth0`) с помощью команды `ip route`.

![Захват ARP и ICMP трафика](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day3/screenshots/s2.jpg)

Захват трафика в Wireshark, демонстрирующий ARP-запрос от хоста `192.168.1.49` для определения MAC-адреса шлюза `192.168.1.1`, ARP-ответ от шлюза и последующий обмен ICMP-пакетами (ping).

![Выполнение команды ping к шлюзу](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day3/screenshots/s3.jpg)

Выполнение команды `ping -c 4 192.168.1.1` для отправки четырех ICMP Echo Request пакетов на IP-адрес шлюза и получение ответных ICMP Echo Reply.

---

## 4. Результаты

*   IP-адрес шлюза по умолчанию (`192.168.1.1`) и используемый сетевой интерфейс (`eth0`) были успешно определены.
*   С помощью команды `ping -c 4 192.168.1.1` было отправлено 4 ICMP Echo Request пакета на шлюз, и получено 4 ответных ICMP Echo Reply.
*   Перед отправкой первого ICMP-пакета, после очистки ARP-кэша, был зафиксирован обмен ARP-сообщениями: ARP-запрос от хоста `192.168.1.49` для определения MAC-адреса шлюза `192.168.1.1` и ARP-ответ от шлюза.
*   Сетевой трафик, включающий ARP и ICMP пакеты, был захвачен с использованием Wireshark на интерфейсе `eth0`.
*   Содержимое ARP-кэша было выведено и сохранено в текстовый файл.
*   Захваченный сетевой трафик сохранен в файл: [`day3_ping.pcap`](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day3/wireshark/day3_ping.pcap).
*   Содержимое ARP-кэша сохранено в файл: [`arp_cache.txt`](https://raw.githubusercontent.com/Nelass1c/practica-konvey/main/day3/arp_cache.txt).

---

## 5. Выводы

*   **Закреплены навыки:** Понимание механизма разрешения MAC-адресов с помощью ARP перед IP-коммуникацией в локальной сети. Освоен анализ ICMP-трафика, генерируемого утилитой `ping`. Улучшены навыки работы с Wireshark для захвата и фильтрации特定类型的 трафика, а также использования команды `ip neigh` для работы с ARP-кэшем.

*   **Что показалось сложным:** Обеспечение гарантированного захвата ARP-обмена потребовало точной последовательности действий, включая предварительную очистку ARP-кэша, так как система кэширует MAC-адреса для оптимизации.

*   **Какой инструмент был наиболее полезен:** Wireshark оказался ключевым инструментом для наглядной демонстрации ARP-запросов/ответов и последующего ICMP-обмена. Команды `ping` и `ip neigh` эффективно дополнили анализ, позволив генерировать трафик и проверять состояние ARP-таблицы.

---
