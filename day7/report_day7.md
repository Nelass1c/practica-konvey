
# Лабораторный отчёт – День 7


**ФИО:** Гул Керим Аллалович
 
**Дата выполнения:** 09.06.2025

**Преподаватель:** Виталий Новиков 


---

## 1. Тема и цель работы

**Тема:** Использование Nmap Scripting Engine (NSE) для поиска уязвимостей

**Цели работы:**

 - Научиться использовать скриптовый движок Nmap (NSE) для автоматизированного поиска известных уязвимостей.
 - Освоить применение опций `-sV` (определение версий) и `--script` (запуск скриптов, включая категории `vulners` и `vuln`).
 - Проанализировать результаты сканирования и идентифицировать потенциальные уязвимости (CVE) на целевом хосте.


---

## 2. Теоретическая часть

*   **NSE (Nmap Scripting Engine):** Мощный инструмент в Nmap, позволяющий пользователям писать (и использовать уже готовые) скрипты для автоматизации широкого спектра сетевых задач, включая продвинутое обнаружение, эксплуатацию и поиск уязвимостей.
*   **Категории скриптов NSE:** Группы скриптов, объединенные по назначению (`default`, `safe`, `vuln`, `auth`, `brute` и др.). Категория `vuln` специально предназначена для поиска известных уязвимостей.
*   **`-sV` (Определение версий):** Ключевая опция Nmap, которая определяет версии служб, работающих на открытых портах. Эта информация критически важна для скриптов, ищущих уязвимости, так как они часто привязаны к конкретным версиям ПО.
*   **CVE (Common Vulnerabilities and Exposures):** Стандартизированный идентификатор для общеизвестных уязвимостей информационной безопасности.
*   **CVSS (Common Vulnerability Scoring System):** Открытый стандарт для оценки серьезности уязвимостей, присваивающий им рейтинг (например, от 0 до 10), на основе которого определяется их критичность (Low, Medium, High, Critical).

---

### 3. Ход работы

Целью данной лабораторной работы было сканирование роутера в локальной сети (`192.168.1.1`) на предмет известных уязвимостей с использованием скриптового движка Nmap (NSE). Работа проводилась в несколько этапов для достижения наиболее полного результата.

#### 3.1. Используемые команды

**Этап 1: Первоначальное сканирование с помощью скрипта `vulners`**

Сначала была предпринята попытка быстрого поиска уязвимостей с помощью популярного скрипта `vulners`, который сверяет версии служб с онлайн-базой данных CVE. Сканирование было нацелено на веб-порты 80 и 443.

```bash
sudo nmap -sV --script=http-enum,vulners -p80,443 192.168.1.1 -oN vulns.txt
```
*   **Результат:** Данное сканирование не выявило уязвимостей, поскольку Nmap не смог определить точную версию веб-сервера, и скрипту `vulners` не хватило данных для проверки.

**Этап 2: Глубокое сканирование с использованием категории скриптов `vuln`**

Чтобы провести более тщательный анализ, было решено использовать весь набор скриптов из категории `vuln`. Для повышения шансов на успех сканирование было нацелено на все ранее обнаруженные открытые порты на роутере.

```bash
sudo nmap -sV --script=vuln -p 22,23,53,80,90,139,222,443,445 192.168.1.1 -oN vulns.txt
```
*   `--script=vuln`: Запускает все скрипты Nmap, предназначенные для поиска уязвимостей.
*   `-p 22,23,53...`: Указывает конкретный список известных открытых портов для целенаправленного сканирования.

*   **Результат:** На этом этапе Nmap смог определить версию веб-сервера `lighttpd 1.4.76` на порту 90 и обнаружил потенциальную уязвимость к DoS-атаке "Slowloris" (CVE-2007-6750). Этот результат был зафиксирован для дальнейшего анализа ([vulns](https://github.com/Nelass1c/practica-konvey/tree/main/day7/vulns.txt)).

---

### 4. Результаты

*   Было проведено двухэтапное сканирование роутера (`192.168.1.1`) с использованием скриптового движка Nmap (NSE).
*   Первоначальное сканирование с помощью скрипта `vulners` не дало результатов из-за невозможности определить точную версию веб-сервера.
*   Более глубокое сканирование с использованием категории скриптов `vuln` было нацелено на все известные открытые порты устройства.
*   В ходе второго сканирования на порту `90/tcp` (служба `lighttpd 1.4.76`) была обнаружена потенциальная уязвимость к DoS-атаке "Slowloris".
*   Данной уязвимости присвоен идентификатор **CVE-2007-6750**, и Nmap пометил ее статус как `LIKELY VULNERABLE` (Вероятно уязвимый).
*   Результаты финального сканирования были сохранены в файл `vulns.txt`.

---

### 5. Выводы

*   **Закреплены навыки:** Освоено применение скриптового движка Nmap (NSE) для автоматического поиска уязвимостей. Закреплены навыки использования различных категорий скриптов (`vulners`, `vuln`) и понята важность определения версий служб (`-sV`) для эффективного сканирования. Получен опыт анализа отчетов Nmap и идентификации CVE.

*   **Что показалось сложным:** Интерпретация результатов, когда сканер не находит уязвимостей из-за недостатка данных (например, неопределенной версии ПО). Также, понимание того, что статус `LIKELY VULNERABLE` требует дальнейшего анализа и не является стопроцентной гарантией наличия уязвимости.

*   **Какой инструмент был наиболее полезен:** Ключевым инструментом выступил Nmap, в особенности его скриптовый движок (NSE) с категорией скриптов `vuln`. Опция `-sV` для определения версий оказалась критически важной для получения осмысленных результатов от скриптов.

---