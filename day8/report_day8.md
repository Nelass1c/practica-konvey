
# Лабораторный отчёт – День 8


**ФИО:** Гул Керим Аллалович
 
**Дата выполнения:** 11.06.2025

**Преподаватель:** Виталий Новиков 


---

## 1. Тема и цель работы

**Тема:** Методы обхода IDS

**Цели работы:**

- Освоить базовые техники обхода IDS с помощью Nmap, такие как подмена порта-источника и изменение длины пакета.
- Выполнить два типа сканирования (обычное и модифицированное) одной и той же цели.
- Проанализировать и сравнить захваченный сетевой трафик от обоих сканирований в Wireshark для наглядной демонстрации работы техник обхода.


---

## 2. Теоретическая часть


*   **IDS (Intrusion Detection System):** Система обнаружения вторжений. Анализирует сетевой трафик или системные события с целью выявления вредоносной активности или нарушений политики безопасности и отправляет оповещения.
*   **Пассивный и Активный OS-фингерпринтинг:**
    *   **Пассивный (p0f):** Анализ существующего трафика для определения ОС хоста без отправки собственных пакетов.
    *   **Активный (Nmap `-O`):** Отправка специально сформированных пакетов на цель и анализ ответов для определения ОС.
*   **Обнаружение сканирования:** IDS могут обнаруживать сканирование по аномалиям в трафике, таким как большое количество запросов к разным портам с одного источника или использование нестандартных комбинаций флагов (например, `SYN+FIN`).
*   **Техники обхода (Evasion Techniques):** Методы, используемые для того, чтобы сканирование не было обнаружено или было ошибочно классифицировано как легитимный трафик.
    *   **Подмена порта-источника (`--source-port`):** Маскировка трафика под легитимную службу, например, DNS (порт 53), трафик которой часто разрешен файрволами.
    *   **Изменение длины данных (`--data-length`):** Добавление случайных данных в пакеты, чтобы их размер отличался от стандартных сигнатур сканеров.
    *   **Использование "приманок" (`--decoy`):** Добавление в сканирование поддельных IP-адресов источников, чтобы скрыть реальный адрес сканирующего хоста.

---

### 3. Ход работы

Для демонстрации техник обхода IDS было проведено два сканирования сетевого роутера (`192.168.1.1`) с использованием утилиты Nmap. Весь трафик обоих сканирований был захвачен в один файл `normal_vs_stealth.pcap` для последующего анализа.

#### 3.1. Используемые команды

**1. "Обычное" сканирование:**
Первым было выполнено стандартное TCP SYN-сканирование для создания базовой сигнатуры трафика.
```bash
sudo nmap -sS -O 192.168.1.1
```

**2. "Скрытное" сканирование (IDS Evasion):**
Второе сканирование было модифицировано для имитации обхода IDS: был подменен порт-источник на `53` (DNS) и к пакетам добавлено 120 байт случайных данных.
```bash
sudo nmap -sS -O --data-length 120 --source-port 53 192.168.1.1
```

#### 3.2. Сравнение трафика

Анализ захваченного трафика в файле ([normal_vs_stealth](https://github.com/Nelass1c/practica-konvey/tree/main/day8/normal_vs_stealth.pcap)) показал следующие ключевые различия:
*   **Обычное сканирование** использовало случайные высокие порты-источники и отправляло пакеты стандартной длины.
*   **"Скрытное" сканирование** отправляло все пакеты с порта-источника `53` и имело увеличенную, нестандартную длину пакетов.

Это различие в характеристиках трафика демонстрирует, как изменение параметров сканирования может помочь замаскировать его от систем обнаружения вторжений, которые ищут предсказуемые сигнатуры.

---

### 4. Результаты

*   Было успешно проведено два типа сканирования роутера `192.168.1.1`: "обычное" и "скрытное".
*   Сравнение результатов показало, что "скрытное" сканирование (с опциями `--data-length` и `--source-port`) вызвало иную реакцию целевой системы: статус закрытых портов изменился с `closed` на `filtered`, и удалось получить предположительную информацию об ОС (Linux 3.X|4.X), в отличие от обычного скана.
*   Анализ трафика в захваченном файле `normal_vs_stealth.pcap` подтвердил, что "обычное" сканирование использовало пакеты стандартной длины с произвольных портов, а "скрытное" — пакеты увеличенной длины с порта-источника `53`.
*   Таким образом, была наглядно продемонстрирована работа техник обхода IDS/Firewall путем маскировки трафика.

---

### 5. Выводы

*   **Закреплены навыки:** Освоены практические методы обхода IDS с помощью опций Nmap (`--data-length`, `--source-port`). Получен опыт сравнения результатов различных типов сканирования. Улучшено понимание важности анализа сетевого трафика в Wireshark для подтверждения работы техник маскировки.

*   **Что показалось сложным:** Анализ и интерпретация различной реакции целевой системы (например, изменение статуса портов с `closed` на `filtered`) в ответ на модифицированные пакеты.

*   **Какой инструмент был наиболее полезен:** Ключевыми инструментами выступили **Nmap** для выполнения сканирований с техниками обхода и **Wireshark** для наглядного анализа и сравнения характеристик сгенерированного трафика (порты-источники, длина пакетов).

---